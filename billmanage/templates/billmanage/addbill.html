{% load static %}
<!doctype html>
<!--
* Tabler - Premium and Open Source dashboard template with responsive and high quality UI.
* @version 1.0.0-beta
* @link https://tabler.io
* Copyright 2018-2021 The Tabler Authors
* Copyright 2018-2021 codecalm.net PaweÅ‚ Kuna
* Licensed under MIT (https://github.com/tabler/tabler/blob/master/LICENSE)
-->
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Bill generated by Dhaka solutionl</title>
    <!-- CSS files -->
    <link href="{% static 'css/tabler.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/tabler-flags.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/tabler-payments.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/tabler-vendors.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/demo.min.css' %}" rel="stylesheet"/>
    <link href="{% static 'typicons.font-2.1.2/src/font/typicons.css' %}" rel="stylesheet"/>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  </head>
  <style>
	.navitemsextra{
	  font-size: 15px;
  font-weight: 500;
  margin: 5px 10px;
  color: white;
  opacity: 1;
	}
	.nav-link{
		background-color: rgb(158 152 255 / 10%)
	}
</style>
  <body class="antialiased">
    <div class="page">
      <aside class="navbar navbar-vertical navbar-expand-lg navbar-dark">
        <div class="container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
            <span class="navbar-toggler-icon"></span>
          </button>
          <h1 class="navbar-brand navbar-brand-autodark">
            <a href=".">
              <img src="https://dhakasolution.com/img/logo.png" width="auto" height="50" alt="dhakasolution" class="mt-2">
            </a>
          </h1>
         
          <div class="collapse navbar-collapse" id="navbar-menu">
            <ul class="navbar-nav pt-lg-3">
              <li class="navitemsextra nav-item">
                <a class="nav-link" href="{% url 'dashboard' %}" >
                  <span class="nav-link-icon d-md-none d-lg-inline-block" style="margin-top: -6px; font-size: 20px"><i class="typcn typcn-home-outline"></i></span>
                  <span class="nav-link-title" >
                    Dashboard
                  </span>
                </a>
              </li>
              <li class="navitemsextra  activenav active  nav-item">
                <a class="nav-link" href="{% url 'addbill' %}" >
                  <span class="nav-link-icon d-md-none d-lg-inline-block" style="margin-top: -6px; font-size: 20px"><i class="typcn typcn-document-add"></i></span>
                  <span class="nav-link-title" style="
                  border-bottom: 2px solid white;">
                    New Bill
                  </span>
                </a>
              </li>
              <li class="navitemsextra nav-item">
                <a class="nav-link" href="{% url 'records' %}" >
                  <span class="nav-link-icon d-md-none d-lg-inline-block" style="margin-top: -6px; font-size: 20px"><i class="typcn typcn-archive"></i></span>
                  <span class="nav-link-title">
                    Bill Records
                  </span>
                </a>
              </li>
              <li class="navitemsextra nav-item">
                <a class="nav-link" href="{% url 'dashboard' %}" >
                  <span class="nav-link-icon d-md-none d-lg-inline-block" style="margin-top: -6px; font-size: 20px;"><i class="typcn typcn-lock-open"></i></span>
                  <span class="nav-link-title">
                    help
                  </span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </aside>
	  <style>
		  .companyname{
			align-items: center;
			height: 40px;
			margin: 4px;
			font-size: 30px;
			font-weight: 600;
			font-family: initial;
			width: max-content;
			background-color: rgb(1, 1, 75);
			color: white;
		  }
		  .companyname > span{
			  margin:8px
		  }
		  .duplicatemark{
							margin: 0;
							padding: 0;
							color: black;
							font-size: 10px;
						}
						.duplicatemark > li{
							padding: 3px;
							width: 65px;
							margin: 1px;
							text-align: center;
						}
	  </style>
      <div class="content">
        <div class="container-xl">
			<!-- Page title -->
			<div class="page-header d-print-none">
			  <div class="row align-items-center">
				<div class="col" style="zoom: 130%;">
					<div class="page-pretitle">
						Dhaka Solution
					  </div>
					  <h2 class="page-title">
						Add new Bill
					  </h2>
				</div>
				<!-- Page title actions
				<div class="col-auto ms-auto d-print-none">
				  <button type="button" class="btn btn-primary" onclick="printDiv('invoice').print();">
					Print Invoice
				  </button>
				</div> -->
			  </div>
			</div>
			<div class="card card-lg" id="invoice" style="width: 95%; margin:auto">
			  <div class="card-body">
				  <div class="row text-center">
					  <h2 style="font-weight:600;border-bottom: 2px solid gray; margin-bottom: 2rem;">Tax Invoice</h4>
				  </div>
				<div class="row">
				  <div class="col-6">
					<div class="row">
						<div class="col-12">
							<p> GSTIN: 09AHVPB2268D1Z9</p>
						</div>
					</div>
					<div class="row">

						<div class="col-12">
							<h1 class="navbar-brand navbar-brand-autodark">
								<a href=".">
								  <img src="https://dhakasolution.com/img/logo.png" width="auto" height="50" alt="dhakasolution" class="mt-2">
								</a>
							  </h1>

							<div>
								<p style="text-align: center; font-weight: 600; margin-top: 5px; width: max-content;">
									<span style="font-size: 17px;">Software company</span><br>
									BNS tower, Uttara <br> Dhaka - 1230 
								</p>

							</div>
						</div>

					</div>
					<style>
						
					</style>
					
				  </div>
				  <div class="col-6" style="padding-left: 11rem">
					<p style="font-size: 15px; font-weight: 600;">Mob. : 000000 <br> E-mail : <E-mail>dhaka@gmail.com</E-mail></p>
					<br>
					<ul class="d-flex duplicatemark">
						<li style="border: 1px solid black; list-style: none;">Original</li>
						<li style="border: 1px solid black; list-style: none;">Duplicate</li>
						<li style="border: 1px solid black; list-style: none;">Triplicate</li>
					</ul>
				  </div>
				</div>
				<hr style="margin-top: 1px;">
				<form action="{% url 'addbill_submitted' %}" method="POST">
				{% csrf_token %}
				 <div class="row">
					<div class="col-lg-8 col-md-8 col-sm-12">
						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Name </label>
							<div class="col">
							  <input name="rname" type="text" class="form-control" placeholder="Enter Recipient's Name" required>
							</div>
						</div>
						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Address </label>
							<div class="col">
							  <input name="address" type="text" class="form-control" placeholder="Enter Recipient's Address" required>
							</div>
						</div>

						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Email </label>
							<div class="col">
							  <input name="email" type="text" class="form-control" placeholder="Enter Recipient's Email">
							</div>
						</div>
						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Phone</label>
							<div class="col">
							  <input name="phone" type="text" class="form-control" placeholder="Enter Recipient's Phone number" required>
							</div>
						</div>

						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Issu By</label>
							<div class="col">
							  <input name="issuby" type="text" class="form-control" placeholder="Enter Issuied Person Name" required>
							</div>
						</div>



						{% comment %} <div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">GST </label>
							<div class="col">
							  <input name="gst" type="text" minlength="15" maxlength="15" class="form-control" oninput="this.value = this.value.toUpperCase()" placeholder="Enter Recipient's GST number" required>
							</div>
						</div> {% endcomment %}
					</div>
					
					<div class="col-md-4 col-lg-4 col-sm-12 text-center">
						<div class="form-group">
							<label class="pb-2" style="border-bottom: 1px solid gray ; font-size: 17px;">Invoice no.</label>
							<div class="mt-2" id="billno">{{billno}}</div>
						</div>
						<hr style="margin: 1.2rem;">
						<div class="form-group row mb-3">
							<label class="form-label col-2 col-form-label">Date </label>
							<div class="col">
							  <input name="date" type="date" class="form-control" id="date" required>
							</div>
						</div>
					</div>
				 </div>
				 <hr>
				 <label class="mb-4 form-label col-2 col-form-label" style="font-size: 15px; border-bottom: 1px solid gray ;">Items</label>
				 <div class="item_container" id=items>
					<div class="page-title">1.</div>
					<div class="mb-4 p-2" style="border:1px solid lightgray;">
						
						<div class="row mb-3">
							<div class="col-9 form-group">
								<label class="mb-1 form-label col col-form-label" for="description">Description</label>
								<input class="form-control" type="text" name="ItemName[]" placeholder="Description of item" required>
							</div>


							{% comment %} <div class="col-3 form-group">
								<label class="mb-1 form-label col col-form-label" for="HSN">HSN Code</label>
								<input class="form-control" type="number" name="hsn[]" placeholder="HSN Code" required>
							</div> {% endcomment %}


						</div>
						<div class="row mb-3">
							<div class="col-4 form-group">
								<label class="mb-1 form-label col col-form-label" for="qty">Quantity</label>
								<input class="form-control" type="number" id="qty0" name="qty[]" placeholder="Quantity" required>
							</div>
							<div class="col-4 form-group">
								<label class="mb-1 form-label col col-form-label" for="rate">Rate</label>
								<input class="form-control" type="number" id="rate0" name="rate[]" placeholder="Rate" required>
							</div>
							<div class="col-4 form-group">
								<label class="mb-1 form-label col col-form-label" for="amount">Amount</label>
								<div class="form-control" class="amount" id="amount" >
								</div>
							</div>
						</div>
					</div>
				</div>
				<button id="addmore" class="float-end add_form_field btn btn-primary" style="margin: -1rem 0rem;"><i class="typcn typcn-document-add" style="font-size: 16px;"></i>&nbsp; Add Item</button>
				<hr style="margin-top: 10%;">
				<div class="row justify-content-center" style="width: 80%; text-align: center; margin: auto;">
					<div class="col-3">
						<label class="form-label col-form-label" style="border-bottom: 1px solid gray;">Total Amount</label>
						<div class="mt-2" style="font-size: 17px;">Rs. <span id="amt">0</span></div>
					</div>
					<hr style="    width: 1px;height: auto;margin: 0 10px;padding: 0;">

					<div class="col-2">
						<label class="form-label col-form-label" style="border-bottom: 1px solid gray;">CGST(tax rate%)</label>
						<div class="mt-2" style="font-size: 17px;">
							<input type="decimal" name="CGST" id="CGST" class="form-control" >
						</div>
					</div>
					
					<hr style="    width: 1px;height: auto;margin: 0 10px;padding: 0;">

					{% comment %} <div class="col-2">
						<label class="form-label col-form-label" style="border-bottom: 1px solid gray;">SGST(%)</label>
						<div class="mt-2" style="font-size: 17px;"><input type="decimal" name="SGST" id="SGST" class="form-control"></div>
					</div> {% endcomment %}

					<hr style="    width: 1px;height: auto;margin: 0 10px;padding: 0;">
					<div class="col-3">
						<label class="form-label col-form-label" style="border-bottom: 1px solid gray">Grand Total</label>
						<div class="mt-2" style="font-size: 17px;">Rs. <span id="grandamt">0</span></div>
					</div>
					<hr style="width: 1px;height: auto;margin: 0 10px;padding: 0;">
				</div>

				<div class="form-group row mb-3" style="margin-top:20px;">
					<label class="form-label col-2 col-form-label">Notice </label>
					<div class="col">
					  <input name="notice" type="text" class="form-control" placeholder="Enter if You have notice">
					</div>
				</div>





				<input type="submit" class="btn btn-success" value="Save">
				</form>
				<div class="modal modal-blur fade" id="limit" tabindex="-1" role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-sm modal-dialog-centered" role="document">
					  <div class="modal-content">
						<div class="modal-body">
						  <div class="modal-title">Maximum Item limit reached.</div>
						  <div>Please create another bill to add more items.</div>
						</div>
						<div class="modal-footer">
						  <button type="button" class="btn btn-success me-auto text-end" data-bs-dismiss="modal">Close</button>
						</div>
					  </div>
					</div>
				  </div>
				  <script>
					Date.prototype.toDateInputValue = (function() {
						var local = new Date(this);
						local.setMinutes(this.getMinutes() - this.getTimezoneOffset());
						return local.toJSON().slice(0,10);
						});
					$(document).ready( function() {
						$('#datePicker').val(new Date().toDateInputValue());
					});
					document.getElementById('date').value = new Date().toDateInputValue();
				</script>
				<script>
				$(document).ready(function() {
					var max_fields      = 6;
					var wrapper         = $(".item_container");
					var add_button      = $(".add_form_field");
				
					var x = 1;
					$(add_button).click(function(e){
						e.preventDefault();
						if(x < max_fields){
							$(wrapper).append('<div class="page-title">'+(x+1)+'.</div><div class="mb-4 p-2" style="border:1px solid lightgray;"><div class="row mb-3"><div class="col-9 form-group"><label class="mb-1 form-label col col-form-label" for="description">Description</label><input class="form-control" type="text" name="ItemName[]" placeholder="Description of item" required></div><div class="col-3 form-group"><label class="mb-1 form-label col col-form-label" for="HSN">HSN Code</label><input class="form-control" type="number" name="hsn[]" placeholder="HSN Code"></div></div><div class="row mb-3"><div class="col-4 form-group"><label class="mb-1 form-label col col-form-label" for="qty">Quantity</label><input class="form-control" type="number" name="qty[]" id="qty'+x+'" placeholder="Quantity" required></div><div class="col-4 form-group"><label class="mb-1 form-label col col-form-label" for="rate">Rate</label><input class="form-control" type="number" name="rate[]" id="rate'+x+'" placeholder="Rate" required></div><div class="col-4 form-group"><label class="mb-1 form-label col col-form-label" for="amount">Amount</label><div class="form-control" class="amount" id="amount'+x+'" ></div></div></div></div>');//add input box
							x++;
						}
						else
						{	
							$('#limit').modal('show');
						}
					});
				
					
				});
				</script>
				<script>
					
					$(document).ready(function(){
						var index = 0;
						
						var amountind = new Array(14);
						$('#addmore').click(function(){
							index++;
							$('#qty'+index).keyup(function(){
							var sum = 0;
							var qty = $("input[name='qty[]']");
							var rate = $("input[name='rate[]']");
							if(qty[index].value && rate[index].value){
								amountind[index] = parseInt(qty[index].value) * parseInt(rate[index].value);
								$('#amount'+index).text(amountind[index]);
								for ( var i = 0; i<amountind.length; i++){
									var currentamt = parseInt(amountind[i]);
									if(Number.isInteger(currentamt)){
									sum = sum + currentamt;
									}
								}
							}
							$('#amt').text(sum);
							$('#grandamt').text(sum);
						});
						$('#rate'+index).keyup(function(){
							var sum = 0;
							var qty = $("input[name='qty[]']");
							var rate = $("input[name='rate[]']");
							if(qty[index].value && rate[index].value){
								amountind[index] = parseInt(qty[index].value) * parseInt(rate[index].value);
								$('#amount'+index).text(amountind[index]);
								for ( var i = 0; i<amountind.length; i++){
									var currentamt = parseInt(amountind[i]);
									if(Number.isInteger(currentamt)){
									sum = sum + currentamt;
									}
								}
							}
							$('#amt').text(sum);
							$('#grandamt').text(sum);
							
						});
						});
						$('#qty'+index).keyup(function(){
							var sum = 0;
							var qty = $("input[name='qty[]']");
							var rate = $("input[name='rate[]']");
							if(qty[index].value && rate[index].value){
								amountind[index] = parseInt(qty[index].value) * parseInt(rate[index].value);
								$('#amount'+index).text(amountind[index]);
								for ( var i = 0; i<amountind.length; i++){
									var currentamt = parseInt(amountind[i]);
									if(Number.isInteger(currentamt)){
									sum = sum + currentamt;
									}
								}
							}
							$('#amt').text(sum);
							$('#grandamt').text(sum);
							
						});
						$('#rate'+index).keyup(function(){
							var sum = 0;
							var qty = $("input[name='qty[]']");
							var rate = $("input[name='rate[]']");
							if(qty[index].value && rate[index].value){
								amountind[index] = parseInt(qty[index].value) * parseInt(rate[index].value);
								$('#amount').text(amountind[index]);
								for ( var i = 0; i<amountind.length; i++){
									var currentamt = parseInt(amountind[i]);
									if(Number.isInteger(currentamt)){
									sum = sum + currentamt;
									}
								}
							}
							$('#amt').text(sum);
							$('#grandamt').text(sum);
						});
						
						$('#CGST,#SGST').keyup(function(){
							var cgst = parseInt($('#CGST').val());
							var sgst = parseInt($('#SGST').val());
							var amount = parseInt(document.getElementById('amt').innerText);
							if(cgst>0 && sgst>0 && amount>0){
								var tax = ((cgst+sgst)/100)*amount;
								var gd = parseInt(amount) + tax;
								$('#grandamt').text(gd);
							}
						});
					});
				</script>
				
				<!--
				<table class="table table-transparent table-responsive">
				  <thead>
					<tr>
					  <th class="text-center" style="width: 1%"></th>
					  <th>Product</th>
					  <th class="text-center" style="width: 1%">Qnt</th>
					  <th class="text-end" style="width: 1%">Unit</th>
					  <th class="text-end" style="width: 1%">Amount</th>
					</tr>
				  </thead>
				  <tr>
					<td class="text-center">1</td>
					<td>
					  <p class="strong mb-1">Logo Creation</p>
					  <div class="text-muted">Logo and business cards design</div>
					</td>
					<td class="text-center">
					  1
					</td>
					<td class="text-end">$1.800,00</td>
					<td class="text-end">$1.800,00</td>
				  </tr>
				  <tr>
					<td class="text-center">2</td>
					<td>
					  <p class="strong mb-1">Online Store Design &amp; Development</p>
					  <div class="text-muted">Design/Development for all popular modern browsers</div>
					</td>
					<td class="text-center">
					  1
					</td>
					<td class="text-end">$20.000,00</td>
					<td class="text-end">$20.000,00</td>
				  </tr>
				  <tr>
					<td class="text-center">3</td>
					<td>
					  <p class="strong mb-1">App Design</p>
					  <div class="text-muted">Promotional mobile application</div>
					</td>
					<td class="text-center">
					  1
					</td>
					<td class="text-end">$3.200,00</td>
					<td class="text-end">$3.200,00</td>
				  </tr>
				  <tr>
					<td colspan="4" class="strong text-end">Subtotal</td>
					<td class="text-end">$25.000,00</td>
				  </tr>
				  <tr>
					<td colspan="4" class="strong text-end">Vat Rate</td>
					<td class="text-end">20%</td>
				  </tr>
				  <tr>
					<td colspan="4" class="strong text-end">Vat Due</td>
					<td class="text-end">$5.000,00</td>
				  </tr>
				  <tr>
					<td colspan="4" class="font-weight-bold text-uppercase text-end">Total Due</td>
					<td class="font-weight-bold text-end">$30.000,00</td>
				  </tr>
				</table>-->
				<p class="text-muted text-center mt-5">Thank you very much for doing business with us. We look forward to working with
				  you again!</p>
			  </div>
			</div>
		  </div>
        <footer class="footer footer-transparent d-print-none">
          <div class="container">
            <div class="row text-center">
              
              <div class="col-12">
                <ul class="list-inline list-inline-dots mb-0">
                  <li class="list-inline-item">
                    Copyright &copy; 2021
                    All rights reserved.
                  </li>
                  <li class="list-inline-item">
                      Built by <a href="https://www.github.com/hosenmdaltaf">Hosen MD Altaf</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <!-- Libs JS -->
    <script src="{% static 'js/apexcharts.min.js' %}"></script>
    <!-- Tabler Core -->
    <script src="{% static 'js/tabler.min.js' %}"></script>
	<script>
	function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}
	</script>
  </body>
</html>